Warfare Alife Overhaul
version: 1.5-beta2
by Vintar

for Anomaly 1.5.3


To install via Mod Organizer:

1. Import the WarfareALifeOverhaul.zip file into Mod Organizer
2. Follow the installer, selecting any optionals and patches necessary. Check that your load order has WarfareALifeOverhaul overwriting any addons you selected patches for.
3. (Highly Recommended) Install Hawkie's Warfare Mechanic Fix, which fixes workbench tool persistence.
4. Load an 'Alife Overhaul' warfare preset (menu is top-right of screen). Apply a preset BEFORE starting a new game, otherwise respawn timer changes will not take place until the next respawn occurs. If you do not use one of the Alife Overhaul presets, make sure that free stalkers and ecologists are participants in warfare. Do NOT disable them from participating.


To install manually:
1. Drop the 'gamedata' folder into your Anomaly root directory (merge it with your existing 'gamedata' folder).
2. Install any optionals desired.
3. Install any patches that are needed.
4. (Highly Recommended) Install Hawkie's Warfare Mechanic Fix, which fixes workbench tool persistence.
5. Load an 'Alife Overhaul' warfare preset (menu is top-right of screen). Apply a preset BEFORE starting a new game, otherwise respawn timer changes will not take place until the next respawn occurs. If you do not use one of the Alife Overhaul presets, make sure that free stalkers and ecologists are participants in warfare. Do NOT disable them from participating.

NOTE: The fomod folder is not used if you do not use Mod Organizer, or are installing this addon manually.


Description:

Warfare is an extremely cool idea, but its implementation with Anomaly is somewhat... incomplete. It deserves to be more than a tacked-on mode. This addon aims to fix that through a combination of bug-fixing and new features.

This addon is compatible with existing Anomaly 1.5.1/1.5.2 Warfare save files, and has no impact on non-warfare games.


Version Log:


1.5.0 - Squad dispatch refactored into three time-of-day-aware functions: process_base_squads (sends squads to resources in the morning, handles overflow at sunset), process_resource_squads (recalls squads to bases at night), and process_territory_squads (same nighttime recall logic for territories). Squads now move outward at dawn, consolidate at sunset, and hold position at night. Overflow squads are redirected to nearby friendly, then neutral, then hostile bases via find_nearby_bases(); squads with no valid destinations are deleted. Base vacancy is now computed properly, accounting for invasion staging and stationary/guard squads. Night activity system added: each smart terrain rolls once per night against a faction-specific night_activity_chance, allowing select factions (notably Monolith, raised from 8% to 50%) to operate at night while most factions stand down. Mutant spawns are now level-stratified into six pools (south, mid, north, labs â€” each with normal and rare variants) instead of the old flat list. Labs specifically spawn underground-appropriate mutants with dedicated rare pools (poltergeists, burers, psysuckers). Monkeypatching cleanup: ~70 lines removed from warfare_monkeypatches.script; faction_expansions.script now natively owns all spawn section overrides and squad quality chance formulas (get_advanced_chance, get_veteran_chance). New mod_simulation_warfare.ltx config overrides initial smart terrain populations for lore-appropriate squad compositions (Duty bunker, Army Cordon positions, Bandit territory, Ecolog terrain). ~30 additional named/quest squads added to the offline combat simulator exclusion list.
1.4.7 - Level priority settings no longer affect random patrol targeting, preventing priority sliders from unintentionally biasing patrol spawns. Minimum resurgence wait time is now enforced at 1000 to prevent premature revival attempts. Resurrection can now begin from lairs as a valid starting location.
1.4.6 - When loading a save from before 1.4.3, defense and patrol spawn timers are now staggered randomly on load to prevent all bases from spawning at once. Mutant spawn timers saved to file are now clamped to the current option maximum on load, so reducing the max mutant respawn time setting takes effect immediately rather than waiting for existing timers to expire.
1.4.5 - Added global spawn speed option allowing players to adjust overall spawn pacing. Squads no longer spawn during nighttime (night spawn pause). Spawn timers now advance gradually after time travel (sleep/wait). Randomized next spawn timers on game start for more organic initial pacing. Fixed mutant overspawn issue. Fixed crash on base capture when the sending base was lost. Fixed distance-based combat multiplier calculation. Fixed spawn timer regression. New preset added with preset cleanup. Fixed veteran spawn chances. Fixed tasks_smart_control squad evaluation.
1.4.4 - Fixed fast travel optional path to scripts.
1.4.3 - Added distance-based combat multipliers to offline combat, so squads further from each other fight less effectively. Spawn timers now properly advance when spawns occur during time travel (sleep, wait). Random patrols no longer target bases, preventing unintended territory expansion via patrols. Added option for new emergency resurgence logic. Spawn timers immediately recalculate when smart terrain count changes. Squad rank now gradually increases over time. Increased veteran spawn chance for smaller factions, which rarely own enough resources for meaningful veteran spawns. Fixed army spawn quality calculation. Simplified main base attack prevention logic. Fixed two crashes, including one in find_random_patrol_target for monster factions.
1.4.2 - Anomaly 1.5.2 support. Fixed offline combat engine issue where targets of any task were permanently exempt from offline combat, regardless of whether the task was accepted/denied - this will fix the massive squad buildups in places like Red Forest/Limansk, where Monolith were often the targets of tasks. Also removed any squad-number limitations to offline combat. Main base attack deprioritization now also affects mutants.
1.4.1 - Added option 'Deprioritize Main Base Attacks'. When enabled, factions will not target enemy main bases unless no other valid targets exist - use this option if you want to add extra safety to quest-givers. As a side effect, this option will prevent a couple of "annoying" situations (Freedom teleporting past the Duty base blockposts, Army attacking Rookie Village, Bandit Base getting insta-wiped by Army, Monolith occupying Skadovsk/Yanov/Laundromat). Mutant spawns depend on any existing mutants on the smart terrain. For example, if it's time to spawn more mutants in Cordon on a lair already occupied by dogs, it will now spawn more dogs (they're multiplying!). So if you hear chatter about a dangerous mutant in your map, you may want to consider hunting it down before it multiplies. Max allowable mutants on each level is now appropriately dependent on the number of the lairs on each level AND your mutant population factor. You can use the "max mutant squads" settings to further restrict the maximum number of mutant squads to your liking. Fixed vanilla Warfare crash when a base with an existing base patrol squad lost ownership. UNISG greatly prioritizes lab entrance locations now - the logic was not fully implemented before, now it is. Actor is now informed of invasions by their faction even when the originating base is off-level. Fixed autocapture of bases that are unowned but already have merchant NPCs present. Added 1.2x respawn timer penalty when using autocapture. Fixed crash when the player helps destroy an invasion force but the defenders died before providing a confirmation message (Credit: Ace). Fixed a rare crash when an invasion target's squad dies mid-assault. Disabled autocapture on the slowest preset. 2X and 5X presets have an additional -1 base boost to enemy factions, so they will spawn faster. Increased mutant maximum number of squads due to new level-dependent mutant capping method. Decreased mutant spawn timers on all presets by 33%. Ecologist respawn times increased. Monolith max spawn time decreased to 1.5x (from 1.7x).
1.4.0 - Autocapture Overhauled: When in the vicinity of a vacant base/resource/territory, take out your PDA. If autocapture is enabled in the settings menu, you will radio a request for a squad to be sent to your location from the nearest base within linked-level range. A squad will spawn from the closest faction base and move to capture the location, and that base's respawn time will be accordingly increased to compensate. If no base is within linked-level range, your request will fail. Loner and ecologist players will not be able to autocapture. If you prefer the old autocapture, there is an option to revert to the old autocapture method in the Warfare general settings. You can now gain faction goodwill by killing enemies: the amount of influence received is calculated identical to money-on-kill, as base + (rank * multiplier). Default settings, as an example, would give 30 goodwill from killing a legendary enemy STALKER. Additionally, loners receive half the normal influence gain and zero kill money (who's gonna pay you?). Added back 'Hide all smarts' functionality. Info messages about invasion attacks and defenses have been updated to more immersive formats. Distance which the player is informed of incoming invasions has been increased by 25%. Removed outdated igi tasks module. Changed some territory terrains in Outskirts to lair terrains. Preset Changes: All presets given goodwill-on-kill base = 0, weight = 0.001. Autocapture is now enabled on all presets, and its settings have been altered due to the overhaul. Clear Sky respawn times +10%. Monolith max respawn time decreased to 1.7x (from 1.8x).
1.3.9 - Squads will no longer travel between Yantar and Dead City until the Miracle Machine is deactivated. Extended evacuation of loner/ecologists from neutral locations under attack to non-invasion attacks, and improved consistency of their departure. Reverted document turn-in to hard-change to dialogs.script, since a few people were having crashing issues. Cleaned up targeting functions so that they work as intended. Mutants can no longer spawn on smart terrains lacking the "lair" property. Minor code optimizations. Removed igi tasks 2.10 patch and added igi tasks 2.11 extra tasks module. Loner random patrol respawn times decreased -50%. Bandit respawn times decreased (now -30% vs -25% before).
1.3.8 - Monolith/Sin/Zombified players playing Storymode+Warfare will now start with the emitters on, but will also start with a good psy helmet to protect them. Loners/ecologists will evacuate neutral locations that are under attack by an invasion force. Level priority sliders actually function now - they didn't in vanilla Warfare. Bloodsuckers and Snorks are no longer part of the 'standard' non-rare mutant spawn list. Used monkey-patching to remove need for direct changes to dialogs.script, xr_conditions.script, xr_effects.script, and their presence in compatibility patches (Respawn Mode, LTTZ DC). Patched a non-Warfare-specific issue where escorting the scientists from Jupiter could be unfinishable (thanks Hexef). Fixed some descriptions for Ecologist Warfare trader's quests (thanks Hexef).
1.3.7 - Storymode location mapspots can be re-enabled as an optional feature. Negative level preferences in the Warfare settings and in simulation_objects_props.ltx are now properly accounted for in targeting priority calculations. Overflow squad targeting now accounts for Warfare level priority settings. Patrol respawn time no longer shows up in the tooltip if base patrol squads pop factor is zero. Loner/ecolog random patrols no longer have an initial target set by random patrol functions, and are instead wholly controlled by loner/ecolog behaviors. Loner/ecolog random patrols are once-again tracked as random patrols and therefore subject to the random patrol limit imposed in their warfare settings. Added slider for maximum number of mutant squads for underground levels (labs) - presets default to 5 squads. Random patrols no longer spawn too close to the player. Adjusted money rank weight slider limits and interval. All factions' respawn timers now have greater discrepancy between min and max times. Military respawn timers decreased (now 2.2x vs 2.5x before). Loner respawn times from bases increased, respawn times from random patrols decreased. Ecologists can now rarely spawn a few random patrol squads.
1.3.6 - Military significantly changed: Now, they only target bases, and spawn 2.5x slower than normal factions. However, their squad quality is based on number of bases instead of resources. They still have a -33% offline combat penalty to promote an army actor to stay on-level with their troops during large attacks/defenses. This option to use bases instead of resources for squad quality is now a faction-specific option. RELOAD your preset to get these changes. Expansion aggression now affects how quickly a faction will send squads to take empty locations. Initial mutant spawns on new game are less conservative, and better about checking valid terrains. The feature 'Contested terrains strain relations' can now be toggled in the Warfare general options menu. The actor is now informed of invasions departing on their level that are targeting enemies on-level. Updated patch for the Respawn Mode addon. Updated tooltip of mutant/stalker population caps to clarify their function in Warfare vs story mode. Mercenaries spawn times increased +8% (now +33% vs +25% before). Bandit spawn times increased +5% (now -25% vs -30% before). Monolith respawn times reduced (now 3x-1.8x vs 4x-2x before). Sin respawn times -33% (now 2x vs 3x before). Corrected error where rare mutant chance in labs was at 75% instead of the intended 50%.
1.3.5 - Monolith can no longer target southern areas of the Zone (Below Red Forest / Radar / Limansk) unless they are the player's faction. If they are the player's faction, they will target southern levels with 80% reduced priority. Normal factions (not Monolith/Sin) can no longer target Radar or Pripyat while the Brain Scorcher is still active. Companion squads are no longer affected by surge behavior, causing 'confused' behavior. They will survive surges as long as they follow you into shelter. Monolith squads are no longer affected by surge behavior, since they are immune. Rare mutant spawns and faction targeting now properly account for Jupiter underground and Lab X8. Added combined patch for LTTZ DC and Respawn Mode. Small code optimizations. FOMOD installer included for MO2 users.
1.3.4 - Warfare-spawned traders now use inventories of their respective factions, and increase their inventory based on your goodwill to their faction. Attacks from random patrol squads no longer trigger invasion defense behavior. Stalker population factors greater than 1 spawn more initial squads on new game start (restored functionality). Added patch for Igi tasks, to prevent 'Scout the Area' from deleting NPCs already present at the target areas.
1.3.3 - Added capability for bases to send out immediate invasions if they have a power advantage over the enemy's current defenses. Fixed invasion calculation overestimate, where the target could be counted as reinforcing itself. New games can now use any stalker_population_factor while still spawning all important characters. Invasion defense response now depends on max_invasion_size_factor instead of a set factor. A defending faction will now request enough reinforcements to get a power advantage equal to incoming invasion's power times the max_invasion_size_factor of the defending faction. Useless smart terrains are now hidden via a setting 'Hide useless smart terrains', enabled by default for the presets. Random patrols now preferentially spawn from a faction's owned locations. Loner and ecologist 'random patrols' can now spawn on any neutral location. Ecologist random patrols are also 'forgotten' so that they are processed correctly. Night activity chance now checks once per night per smart terrain - this will greatly reduce the incidence of 'teleporting squads' after sleeping. Overflow squads now only move off terrains during daylight, or if the smart is cleared for night activity. Overflow squad removal now only occurs when the squad has no valid targets anywhere in the Zone. The player is now informed of incoming attacks only when the attackers are relatively close. The player is also informed when the position is no longer under attack. Fixed rare issue where, on game load, ignore_list squads sharing a terrain with neutrals could be moved off their smart terrains. Removed black smoke poltergeist from spawn list. Added patch for bmblbx's addons, which include: dynamic mutants, dynamic nocturnal mutants, teleport anomalies. All STALKER spawn times +20%. Army aggression lowered, resource priority greatly lowered, min respawn time +5%, max resurgence time 3x longer. Bandit respawn times -5% (now -30% vs -25% before). Monolith min respawn time -20%. Loner respawn times adjusted (revert to +25% max respawn time, random patrol spawn times greatly reduced). Loners and ecologists spawn slightly less often as Advanced and Veteran. Renegade random patrol respawn times greatly reduced.
1.3.2 - Added patches for Respawn Mode and LTTZ Director's Cut. Added optional fast travel + Warfare fix. Minor smart terrain property changes, to accommodate weird job locations in Yantar. Army min respawn time +10% increase. Bandit respawn times reduced by -5%. Loner max respawn time slightly reduced (now +20% vs +25% before).
1.3.1 - Underground smart terrains can no longer be the target of bases. Bases can no longer donate squads to nearby invasion forces if they're under attack. Invasions are no longer planned for neutral loner/ecolog resources, or empty terrains. Invasion plans are now also re-assessed when a faction loses bases/resources. 'Under attack' status is tracked and carried over between game saves/loads. Fixed relations immediately deteriorating after a ceasefire due to targets being 'stolen'. New games now spawn more mutants on each level, the amount is dependent on your mutant population factor setting. Random start mutant spawns now spawn on lairs instead of territories. Army squads in Cordon start as stationary, to prevent an instant attack on the Rookie Village. The Bar informator and the Zaton mechanic no longer spawn clones on a new game start (vanilla Warfare bug). Alife Overhaul (10x) Preset: enemy base boost changed to -5.
1.3.0 - Faction AI overhauled: see detailed changelist for more info. Fixed 'Escort the Ecologists' quest functionality, and guaranteed that the target anomaly field is located on-level. Fixed issue with 'resurgence chance' not working. Added toggle setting for the extra loner fog of war. You can now station squads beyond the smart terrain capacity when 'manual control' is active. Added toggle setting to allow auto-overflow handling even during manual faction control. Fixed non-recognition of CoP 'story' mutants by offline combat, so squads can fight back again. Resurgence attempts are now much stronger, and therefore more likely to succeed. Added more story squads to ignore list, which should improve story mode consistency. Preset updated to account for new invasion logic, and for balance. Duty patrols changed to random patrols targeting only lairs. Added more squads to stationary list, including many initial veteran squads of some factions. Friendly random patrol squads are now clearly labeled in the tooltip. Numerous code optimizations. Russian localization: tooltips for Warfare settings restored, and new descriptions run through Google Translate.
1.2.0 - Compatibility for Anomaly version 1.5.1. 'Hybrid' offline combat mode has been removed. Restored 'Offline Combat Distance' in the Warfare general settings. 'Resurgence Chance' is now an additional Warfare parameter that can be tweaked for each faction: it is the percent chance that a faction will carry out a resurgence (i.e. revival) attempt. Altered ignored squads and added stationary squads functionality.
1.1.7 - Story mode + Warfare simultaneously available - requires new game with both options ticked. Loner behavior updated - they are now more risk-averse when it comes to attacking hostile resources. Loner player no longer sees other loner squads/bases while fog of war is active without PDA v2/v3. Fixed bug where respawn timers could be reset by visiting loner/ecolog squads. Fixed vanilla bug where random patrols were unmarked upon game save/load. Fixed crash related to Jupiter scientists. Many story squads added to ignore/special lists. More smart terrain property tweaks. Numerous preset tweaks for improved balance.
1.1.3 - Fixed rare bug where mutant targeting could affect human story squads on unowned points. Overflow squads with no valid targets on linked levels will now be sent to valid targets among all active levels. Fixed edge-case crash pertaining to changing point ownership. Vast increase of preset resurgence time and slider max. Preset balance improvements, particularly for loner and ecologist spawn times. Recognized more mechanics/traders/barmen/medics to prevent duplicate spawning. More smart terrain property tweaks, particularly for the northern zone.
1.1.2 - Squads now seek cover in psi-storms as well. Minor smart terrain property tweaks. Russian localization files have been added to prevent crashes related to that - the descriptions are incorrect, so please consult the changelog for updated descriptions.
1.1.1 - Loners/ecologists will no longer get sent out from a base if an emission is going on. Patrol spawn timers now correctly depend on base count. Descriptions for menu faction settings added, accessible for 'Stalker' faction. Loners/ecologists spawn less often as veteran/advanced. Fixed crash related to smart terrains with no properties.
1.1.0 - First round of quest fixes for Warfare (assault, smart control). Bases recalculate respawn timers when faction control changes. Min/max respawn timers now depend on base count. Alife Overhaul preset respawn timers updated. Hybrid offline combat now has a longer combat/connection distance in story mode. Removed stray comment of overflow squad removal - it now functions again.
1.0.5 - Squads will now seek out shelter from emissions if their current location has none.
1.0.2 - Dynamic relations now works with fog of war. Courtesy of Lignar.
1.0.1 - Base patrol squads can now target lairs as well as territories. This has been added to the preset as a special trait of Duty, since they're known for mutant hunting.


Altered files:
- dialogs.script
- faction_expansions.script
- game_relations.script
- sim_offline_combat.script
- sim_squad_scripted.script
- sim_squad_warfare.script
- smart_terrain_warfare.script
- tasks_assault.script
- tasks_smart_control.script
- ui_mm_faction_select.script
- ui_options.script
- ui_pda_warfare_tab.script
- warfare.script
- warfare_factions.script
- warfare_options.script
- xr_logic.script
- includes.ltx
- offline_combat_simulator.ltx
- simulation_objects_props.ltx
- tm_warfare.ltx
- ui_st_options.xml


Credits:

Werejew for creating Warfare
Illinaru for their warfare addon (Illinaru Warfare Balance), which was the basis for the PDA change, and for their advice
Lignar for providing the solution to the fog of war dynamic relations issue

If you would like to use any of this addon as part of a separate overhaul, feel free to do so. And if you feel like crediting me at all, that would make you a pretty cool person.
